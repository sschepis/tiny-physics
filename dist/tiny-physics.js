(()=>{var N=function(){var f=[],A=!1,g={width:1920,height:1080},c=0,d=[],y={x:0,y:0,width:0,height:0},R=function(s){if(s.objects)for(var a=0;a<s.objects.length;a++)f.push(new F(s.objects[a]));else f.push(new F(s));if(s.speed&&(speed=s.speed),s.viewport&&(y=s.viewport),s.forces)for(var a=0;a<s.forces.length;a++)d.indexOf(s.forces[a])==-1&&d.push(s.forces[a]);s.size&&(g=s.size)},D=function(s){speed=s},L=function(s){y=s},O=function(s){V=s},H=function(s){d.push(s)},T=function(){A=!0},B=function(){A=!1,c==0&&(c=Date.now()),V()},E=function(){c=0;for(var s=0;s<f.length;s++)f[s].rewind()},G=function(){f=[],A=!1,speed=1,c=0};class F{constructor(a){this.type=a.type,this.x=a.x,this.y=a.y,this.vx=a.vx,this.vy=a.vy,this.ax=a.ax,this.ay=a.ay,this.mass=a.mass,this.radius=a.radius,this.width=a.width,this.height=a.height,this.angle=a.angle,this.angularVelocity=a.angularVelocity,this.angularAcceleration=a.angularAcceleration,this.color=a.color,this.lineWidth=a.lineWidth,this.points=a.points,this.renderer=a.renderer,this.lastX=this.x,this.lastY=this.y,this.lastAngle=this.angle}update(a){this.lastX=this.x,this.lastY=this.y,this.lastAngle=this.angle,this.vx+=this.ax*a,this.vy+=this.ay*a,this.x+=this.vx*a,this.y+=this.vy*a,this.ax=0,this.ay=0,this.angularAcceleration=0,this.angularVelocity+=this.angularAcceleration*a,this.angle+=this.angularVelocity*a;for(var h=0;h<d.length;h++)d[h].apply(this,a);this.x<0&&(this.x=g.width+this.x),this.x>g.width&&(this.x=this.x-g.width),this.y<0&&(this.y=g.height+this.y),this.y>g.height&&(this.y=this.y-g.height)}rewind(){this.x=this.lastX,this.y=this.lastY,this.angle=this.lastAngle}render(a){if(this.renderer)this.renderer(a,this);else{var h=this.x-y.x,t=this.y-y.y;h=h/y.width*canvas.width,t=t/y.height*canvas.height;var n=canvas.width/y.width,e=canvas.height/y.height;if(a.beginPath(),this.type=="circle")a.arc(h,t,this.radius*n,0,2*Math.PI,!1);else if(this.type=="rectangle")a.rect(h-this.width*n/2,t-this.height*e/2,this.width*n,this.height*e);else if(this.type=="polygon"){a.moveTo(h+this.points[0].x*n,t+this.points[0].y*e);for(var r=1;r<this.points.length;r++)a.lineTo(h+this.points[r].x*n,t+this.points[r].y*e);a.closePath()}else this.type=="particle"&&a.arc(h,t,2,0,2*Math.PI,!1);a.fillStyle=this.color,a.fill(),a.lineWidth=this.lineWidth,a.strokeStyle=this.color,a.stroke()}a.restore()}}var V=function(){var s=Date.now(),a=s-c;c=s,context.clearRect(0,0,canvas.width,canvas.height);for(var h=0;h<d.length;h++)d[h].render&&d[h].render(context);for(var h=0;h<f.length;h++)f[h].update(a/100);for(var h=0;h<f.length;h++)f[h].render(context);A||requestAnimationFrame(V)},J=function(s,a,h){return{apply:function(t,n){for(var e,r,i,l,v=0;v<f.length;v++)f[v]!=t&&(e=f[v].x-t.x,r=f[v].y-t.y,i=Math.sqrt(e*e+r*r),i>s&&i<a&&(l=h*t.mass*f[v].mass/(i*i),i<s&&(i=s),t.ax+=l*e/i/t.mass,t.ay+=l*r/i/t.mass,f[v].ax-=l*e/i/t.mass,f[v].ay-=l*r/i/t.mass))}}},K=function(s,a,h){return{apply:function(t,n){for(var e=0;e<f.length;e++){var r=f[e];if(r!=t){var i=r.x-t.x,l=r.y-t.y,v=Math.sqrt(i*i+l*l),u=h*t.mass*r.mass/v;v>s&&v<a&&(t.ax+=u*i/(v*t.mass)*n,t.ay+=u*l/(v*t.mass)*n)}}}}},Q=function(s){return{apply:function(a,h){var t=Math.sqrt(a.vx*a.vx+a.vy*a.vy),n=s*t*t;a.vx-=n*a.vx/a.mass*h,a.vy-=n*a.vy/a.mass*h}}},U=function(s){var a=s.springConstant,h=s.dampingConstant,t=s.restLength,n=s.object1;return{apply:function(e,r){var i=n.x-e.x,l=n.y-e.y,v=Math.sqrt(i*i+l*l),u=a*(v-t),M=h*(n.vx-e.vx)*i/v+(n.vy-e.vy)*l/v,m=u+M;e.vx+=m*i/v/object1.mass*r,e.vy+=m*l/v/object1.mass*r,e.vx-=m*i/v/object2.mass*r,e.vy-=m*l/v/object2.mass*r}}},Y=function(s){var a=s.restitution,h=s.left,t=s.top,n=s.right,e=s.bottom;return{apply:function(r,i){r.x-r.radius<h?(r.x=h+r.radius,r.vx=-a*r.vx*i):r.x+r.radius>n&&(r.x=n-r.radius,r.vx=-a*r.vx*i),r.y-r.radius<t?(r.y=t+r.radius,r.vy=-a*r.vy*i):r.y+r.radius>e&&(r.y=e-r.radius,r.vy=-a*r.vy*i)},render:function(){var r=g.width/y.width,i=g.height/y.height,l=h*r,v=t*i,u=(n-h)*r,M=(e-t)*i;context.strokeStyle="red",context.strokeRect(l,v,u,M)}}},Z=function(s){return{apply:function(a,h){for(var t=[],n=0;n<f.length;n++)for(var e=n+1;e<f.length;e++){var r=f[n],i=f[e],l=r.x-i.x,v=r.y-i.y,u=Math.sqrt(l*l+v*v);u<(r.radius+i.radius)*2&&t.push({object1:r,object2:i,distance:u})}if(t.sort(function($,X){return $.distance-X.distance}),!!t.length)for(var M=5,m=0;t.length>0&&m<M;){m++;var x=t.shift(),r=x.object1,i=x.object2,l=r.x-i.x,v=r.y-i.y,u=Math.sqrt(l*l+v*v),x=r.radius+i.radius-u;if(!(x<0)){var w=l/u,p=v/u,P=-p,q=w,W=r.vx*P+r.vy*q,k=i.vx*P+i.vy*q,C=r.vx*w+r.vy*p,I=i.vx*w+i.vy*p,S=(C*(r.mass-i.mass)+2*i.mass*I)/(r.mass+i.mass),z=(I*(i.mass-r.mass)+2*r.mass*C)/(r.mass+i.mass);r.vx=P*W+w*S,r.vy=q*W+p*S,i.vx=P*k+w*z,i.vy=q*k+p*z,r.x+=w*x/2,r.y+=p*x/2,i.x-=w*x/2,i.y-=p*x/2}}}}},_=(s,a,h,t)=>{for(var n=[],e=0;e<t;e++){var r=e/t*Math.PI*2;n.push({x:s+h*Math.cos(r),y:a+h*Math.sin(r)})}return n};return{PhysicsObject:F,create:R,pause:T,resume:B,rewind:E,reset:G,setSpeed:D,setRenderer:O,addForce:H,setViewport:L,createPolygon:_,forces:{gravity:J,drag:Q,spring:U,boundary:Y,repulsion:K,overlapResolver:Z}}}();})();
//# sourceMappingURL=tiny-physics.js.map
