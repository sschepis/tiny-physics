(()=>{var r=class{constructor(t,s,i){this.x=t,this.y=s,this.z=i}add(t){return new r(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return new r(this.x-t.x,this.y-t.y,this.z-t.z)}mul(t){return new r(this.x*t,this.y*t,this.z*t)}div(t){return new r(this.x/t,this.y/t,this.z/t)}mag(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}norm(){return this.div(this.mag())}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}static add(t,s){return t.add(s)}static sub(t,s){return t.sub(s)}static mul(t,s){return t.mul(s)}static div(t,s){return t.div(s)}static mag(t){return t.mag()}static norm(t){return t.norm()}static dot(t,s){return t.dot(s)}distance(t){return r.sub(this,t).mag()}static distance(t,s){return r.sub(t,s).mag()}static cross(t,s){return new r(t.y*s.z-t.z*s.y,t.z*s.x-t.x*s.z,t.x*s.y-t.y*s.x)}static angle(t,s){return Math.acos(r.dot(t,s)/(t.mag()*s.mag()))}static angleBetween(t,s){return Math.atan2(s.y-t.y,s.x-t.x)}static angleBetween3(t,s){return Math.atan2(s.y-t.y,s.x-t.x)}},n=class{constructor(t,s){this.x=t,this.y=s}add(t){return new n(this.x+t.x,this.y+t.y)}sub(t){return new n(this.x-t.x,this.y-t.y)}mul(t){return new n(this.x*t,this.y*t)}div(t){return new n(this.x/t,this.y/t)}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}norm(){return this.div(this.mag())}dot(t){return this.x*t.x+this.y*t.y}static add(t,s){return t.add(s)}static sub(t,s){return t.sub(s)}static mul(t,s){return t.mul(s)}static div(t,s){return t.div(s)}static mag(t){return t.mag()}static norm(t){return t.norm()}static dot(t,s){return t.dot(s)}distance(t){return n.sub(this,t).mag()}static distance(t,s){return n.sub(t,s).mag()}static cross(t,s){return t.x*s.y-t.y*s.x}static angle(t,s){return Math.acos(n.dot(t,s)/(t.mag()*s.mag()))}static angleBetween(t,s){return Math.atan2(s.y-t.y,s.x-t.x)}},f=class{constructor(t,s,i,e,h){this.world=t,this.vertices=s,this.indices=i,this.normals=e,this.uvs=h}},p=class extends PhysicsObject{constructor(t,s,i){super(t,i),this.mesh=s,this.opts=i,this.x=i.x||0,this.y=i.y||0,this.z=i.z||0,this.rx=i.rx||0,this.ry=i.ry||0,this.rz=i.rz||0,this.sx=i.sx||1,this.sy=i.sy||1,this.sz=i.sz||1}update(t){}draw(t,s){t.beginPath();for(let i=0;i<this.mesh.indices.length;i+=3){let e=this.mesh.indices[i],h=this.mesh.indices[i+1],d=this.mesh.indices[i+2],a=this.mesh.vertices[e],c=this.mesh.vertices[h],o=this.mesh.vertices[d],y=s.project(a.x,a.y,a.z),x=s.project(c.x,c.y,c.z),w=s.project(o.x,o.y,o.z);t.moveTo(y.x,y.y),t.lineTo(x.x,x.y),t.lineTo(w.x,w.y),t.lineTo(y.x,y.y)}t.stroke()}},m=class{constructor(t,s){this.world=t,this.objects=s||[]}addObject(t){this.objects.push(t)}update(){for(let t of this.objects)t.update(this.objects)}},l=class{constructor(t){this.opts=t,this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.rx=t.rx||0,this.ry=t.ry||0,this.rz=t.rz||0}project(t,s,i){let e=this.rx*Math.PI/180,h=this.ry*Math.PI/180,d=this.rz*Math.PI/180,a=Math.cos,c=Math.sin,o=t-this.x,y=s-this.y,x=i-this.z,w=o,B=y*a(e)-x*c(e),S=y*c(e)+x*a(e),T=w*a(h)+S*c(h),k=B,q=-w*c(h)+S*a(h),F=T*a(d)-k*c(d),I=T*c(d)+k*a(d);return{x:F,y:I,z:q}}},P=class extends PhysicsEngine{scenes={};curScene="default";constructor(){super(),this.scenes[this.curScene]=new m(this),this.camera=new l({})}update(){super.update(),this.scenes[this.curScene].update()}draw(t){this.scenes[this.curScene].objects.forEach(s=>s.draw(t,this.camera))}addScene(t,s){this.scenes[t]=s}getScene(t){return this.scenes[t]}setScene(t){this.curScene=t}animate(t){this.update(),this.draw(t),requestAnimationFrame(()=>this.animate(t))}};window.Physics||(window.Physics={});window.Physics.DWorld=P;window.Physics.DObject=p;window.Physics.DScene=m;window.Physics.DCamera=l;window.Physics.DMesh=f;window.Physics.Vector2=n;window.Physics.Vector3=r;var g=class{engine;opts;constructor(t,s){this.engine=t,this.opts=s,this.x=s.x||0,this.y=s.y||0,this.vx=s.vx||0,this.vy=s.vy||0,this.ax=s.ax||0,this.ay=s.ay||0}update(t){this.vx+=this.ax,this.vy+=this.ay,this.x+=this.vx,this.y+=this.vy,this.ax=0,this.ay=0}draw(t){t.fillRect(this.x,this.y,10,10)}},M=class extends g{constructor(t,s){super(t,s),this.width=s.width||20,this.height=s.height||20,this.onSurface=!1}update(t){super.update(t),this.y+2*this.height>440&&(this.vy=0,this.onGround=!0)}},b=class extends g{constructor(t,s){super(t,s),this.width=s.width||100,this.height=s.height||10}draw(t){t.fillRect(this.x,this.y,this.width,this.height)}update(t){}},z=class{constructor(t,s){this.engine=t,this.opts=s}apply(t,s){}render(t){}},j=class{constructor(t){t=t||{},this.gravity=98,this.drag=0,this.forces=t.forces||[],this.objects=t.objects||[],t.animate&&t.animateCallback&&this.animate(this.objects,t.animateCallback.bind(this))}static createObject(t,s){return new t(this,s)}static createForce(t){return new z(this,t)}animate(t,s){this.onUpdate=s,this.objects=t||this.objects,this.lastTime=Date.now(),this.tick()}update(t,s){s||(s=this.objects||[]);for(let i=0;i<s.length;i++){let e=s[i];e.update&&e.update(s);for(let h=0;h<this.forces.length;h++)this.forces[h].apply(e,s,t);this.opts.wrap&&this.wrapBounds(e,{x:0,y:0,width:640,height:480})}}wrapBounds(t,s){t.x>s.x+s.width&&(t.x=s.x),t.x<s.x&&(t.x=s.x+s.width),t.y>s.y+s.height&&(t.y=s.y),t.y<s.y&&(t.y=s.y+s.height)}tick(){let t=Date.now(),s=(t-this.lastTime)/1e3;this.lastTime=t,this.update(s,this.objects),this.onUpdate&&(this.onUpdate(this.objects),setTimeout(()=>requestAnimationFrame(this.tick.bind(this)),10))}};window.Physics||(window.Physics={});window.Physics={Engine:j,SolidObject:M,StaticObject:b,Force:z};})();
//# sourceMappingURL=tiny-physics.min.js.map
